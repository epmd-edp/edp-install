# Copyright 2018 EPAM Systems.

# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
# http://www.apache.org/licenses/LICENSE-2.0

# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.

# See the License for the specific language governing permissions and
# limitations under the License.

---
# file: group_vars/all
ansible_connection: ssh
work_dir: "/home/edp"
post_integration_dir: "{{ work_dir }}/post-integration"
secrets_dir: "{{ work_dir }}/secrets"
templates_dir: "{{ work_dir }}/oc-templates"
files_dir: "{{ work_dir }}/files"
edp_name: ""
edp_deploy_project: "{{ lookup('env', 'DEPLOY-PROJECT') }}"
projects_list: [
    "{{ edp_name }}-edp-cicd"
    ]
project_cicd: "{{ edp_name }}-edp-cicd"
full_edp_name: "{{ edp_name }}-edp"
ocadm: "oc --config=/etc/origin/master/admin.kubeconfig"
vcs_integration_enabled: "{{ vcs_integration_enabled | lower | default 'false'}}"
vcs_ssh_port: "{{ vcs_ssh_port | default('7999') if vcs_integration_enabled|bool == true else undefined }}"
vcs_auto_user_secret_name: "{{ 'vcs-autouser-edp-' + edp_name + '-temp' if vcs_integration_enabled|bool == true else undefined }}"
perf_integration_enabled: "{{ perf_integration_enabled | lower | default 'false'}}"
perf_node_id: "{{ perf_node_id if perf_integration_enabled|bool == true else undefined }}"
perf_user_secret_name: "{{ 'perf-user-edp-' + edp_name + '-temp' if perf_integration_enabled|bool == true else undefined }}"
perf_web_url: "{{ perf_url if perf_integration_enabled|bool == true else undefined }}"
ephemeral_data: "{{ (lookup('env', 'EPHEMERAL_DATA') == 'true') | ternary('true', 'false') }}"
dev_deploy: "{{ (lookup('env', 'DEV_DEPLOY') == 'true') | ternary('true', 'false') }}"
default_operators_deploy_project: "{{ edp_name }}-deploy-project"
operators_deploy_project: "{{ default_operators_deploy_project if dev_deploy|bool == true else edp_deploy_project }}"
shared_database: "edp-install-wizard-db"
shared_db_dev_service:  "{{ shared_database }}.{{ edp_name }}-deploy-project"
shared_db_prod_service: "{{ shared_database }}.{{ edp_deploy_project }}"
shared_secrets_mask: "edp-shared-"
stages_repo: "{{ lookup('env', 'STAGES_REPO') | default('https://github.com/epmd-edp/edp-library-stages.git',true) }}"
pipelines_repo: "{{ lookup('env', 'PIPELINES_REPO') | default('https://github.com/epmd-edp/edp-library-pipelines.git',true) }}"
stages_version: "{{ lookup('env', 'STAGES_VERSION') }}"
pipelines_version: "{{ lookup('env', 'PIPELINES_VERSION') }}"
default_super_admin: "admin-{{ edp_name }}-edp"
edp_super_admins: "{{ (super_admin_users == '') | ternary(default_super_admin, super_admin_users.split(',')) | lower }}"
edp_admins: "{{ admin_users.split(',') | lower | default([]) }}"
edp_viewers: "{{ view_users.split(',') | lower | default([]) }}"
gerrit_super_admins: []
gerrit_admins: []
nexus_super_admins: []
nexus_admins: []
nexus_viewers: []
keycloak_super_admins: []
keycloak_admins: []
keycloak_developers: []
basic_pattern_url: "https://github.com/epmd-edp"
tools:
  jenkins:
    web_url: "https://jenkins-{{ project_cicd }}.{{ dns_wildcard | default('delivery.aws.main.edp.projects.epam.com') }}"
    volume_capacity: "{{ jenkins_volume_capacity | default('5Gi') }}"
    version: "{{ jenkins_image_version | default('docker-registry-default.delivery.aws.main.edp.projects.epam.com/infra/edp-jenkins:latest') }}"
  gerrit:
    version: "{{ gerrit_version | default('2.16.10') }}"
    volume_capacity: "{{ gerrit_volume_capacity | default('5Gi') }}"
    web_url: "https://gerrit-{{ project_cicd }}.{{ dns_wildcard | default('delivery.aws.main.edp.projects.epam.com') }}"
  nexus:
    version: "{{ nexus_version | default('3.15.1') }}"
    volume_capacity: "{{ nexus_volume_capacity | default('5Gi') }}"
    web_url: "https://nexus-{{ project_cicd }}.{{ dns_wildcard | default('delivery.aws.main.edp.projects.epam.com') }}"
  sonar:
    version: "{{ sonar_version | default('7.6-community') }}"
    volume_capacity: "{{ sonar_volume_capacity | default('1Gi') }}"
    volume_db_capacity: "{{ sonar_volume_db_capacity | default('2Gi') }}"
    web_url: "https://sonar-{{ project_cicd }}.{{ dns_wildcard | default('delivery.aws.main.edp.projects.epam.com') }}"
  admin_console:
    db_secret: "admin-console-db"
    version: "{{ admin_console_version | default('docker-registry-default.delivery.aws.main.edp.projects.epam.com/infra/edp-admin-console:snapshot') }}"
    web_url: "https://edp-admin-console-{{ project_cicd }}.{{ dns_wildcard | default('delivery.aws.main.edp.projects.epam.com') }}"
    shared_db_service: "{{ shared_db_dev_service if dev_deploy | bool == true else shared_db_prod_service }}"
  keycloak:
    realm_name: "{{ full_edp_name }}"
    web_url: "https://keycloak-security.{{ dns_wildcard | default('delivery.aws.main.edp.projects.epam.com') }}"
  openshift_dashboard:
    web_url: "https://master.{{ dns_wildcard | default('delivery.aws.main.edp.projects.epam.com') }}"
